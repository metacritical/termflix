# Machine-Readable Request for Language Flag Bugfix
# Based on AgentSpec Request Protocol 1.0.0

feature:
  name: Request Protocol
  version: 1.0.0
  purpose: "Formalize the debugging task for language flag rendering inconsistencies in the language filter picker."

request:
  type: "Bugfix"
  source: "Human (User)"
  target: "Agent (Antigravity)"
  priority: "High"

goal: "Ensure language flags (emojis) are displayed correctly in Termflix Text Mode, matching functionality in Kitty Mode."

context:
  description: "In the 'Filter by Language' popup (tmux + text mode), regional-indicator flags (e.g. ðŸ‡¬ðŸ‡§) may appear after a delay and can vanish/reappear while navigating the list."
  files:
    - "bin/termflix"
    - "modules/ui/layouts/language-selector.xml"
    - "modules/ui/tml/parser/tml_parser.sh"
  memory:
    - "2c85626e-0996-4435-91dc-e9c80e24505e" # Debug Language Flag Display conversation

success_criteria:
  - "Flag emoji is visible immediately when the language picker opens."
  - "Flags do not flicker/disappear while navigating the list."
  - "No regression in non-tmux environments (direct terminal)."

known_mitigations:
  - "Language picker forces UTF-8 locale (LC_ALL/LANG=C.UTF-8)."
  - "Sets RUNEWIDTH_EASTASIAN=1 for fzf inside tmux."
  - "Runs fzf with --no-hscroll --no-scrollbar for the language picker."
